---
    name: Continuous Integration
    on:
      workflow_dispatch:
      workflow_call:
      pull_request:
        branches:
          - release

    jobs:
      build-container:
        uses: ./.github/workflows/build-docker-container.yml
        secrets: inherit
        permissions:
          contents: read
          packages: write

      boot-container:
        needs:
            - build-container
        name: Spin the Container up
        runs-on: ubuntu-latest
        steps:
          - name: Docker Compose Up
            working-directory: ./Docker
            run: docker compose -f docker-compose.yml up -d

      # linting:

      container-down:
        needs:
            - boot-container
        name: Shut down the Container
        runs-on: ubuntu-latest
        steps:
          - name: Docker Compose Down
            working-directory: ./Docker
            run: |
              docker compose -f docker-compose.yml down
              docker rm -f $(shell docker ps -a -q)
              docker volume rm $(shell docker volume ls -q)
